---
layout: post
title: 'iDempiere and Buckminster: building a web-based OSGi application'
date: '2017-07-27T08:27:00.002+02:00'
author: Gerald O'Sullivan
tags: 
modified_time: '2017-08-14T06:18:47.655+02:00'
thumbnail: https://2.bp.blogspot.com/-xsVstrKT8bY/WXmHvM39_NI/AAAAAAAAC6U/b4tovODmer48k5KAmtxfat1QOSkVb8loACLcBGAs/s72-c/Buckminster_HelloDemo.gif
blogger_id: tag:blogger.com,1999:blog-5063526183496324043.post-522069927686087350
blogger_orig_url: https://surfacedetail.blogspot.com/2017/07/idempiere-and-buckminster-building-web.html
---

<h2>iDempiere and Buckminster</h2><div>iDempiere is an open source, web-based Enterprise Resource Planning (ERP) system that has been built with tools from the Java world, but instead of using a familiar build automation tool like Maven, or a newer tool like Gradle, the iDempiere team used Buckminster to manage the build.<br /><br /><a href="https://2.bp.blogspot.com/-xsVstrKT8bY/WXmHvM39_NI/AAAAAAAAC6U/b4tovODmer48k5KAmtxfat1QOSkVb8loACLcBGAs/s1600/Buckminster_HelloDemo.gif" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="464" data-original-width="635" height="233" src="https://2.bp.blogspot.com/-xsVstrKT8bY/WXmHvM39_NI/AAAAAAAAC6U/b4tovODmer48k5KAmtxfat1QOSkVb8loACLcBGAs/s320/Buckminster_HelloDemo.gif" width="320" /></a><a href="https://surfacedetail.blogspot.co.za/2017/07/idempiere-and-osgi-modular-java.html" target="_blank">We tackled OSGi in an earlier post</a>, now Buckminster as well? OK, roll up your sleeves...<br /><br />This post looks at the use of Buckminster in the iDempiere project so that we can get a better understanding of the build process, and why Buckminster was used.<br /><br /><h3>What is Buckminster?</h3>Buckminster is a set of frameworks and tools for automating build, assemble and deploy processes.  The project <a href="https://wiki.eclipse.org/Buckminster_Project_FAQ#Why_is_the_project_called_.22Buckminster.22.3F" target="_blank">is named</a>&nbsp;after the architect <a href="https://www.bfi.org/about-fuller" target="_blank">R. Buckminster Fuller</a> who said about problem-solving "when I have finished, if the solution is not beautiful, I know it is wrong."<br /><br /></div><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: right; text-align: right;"><tbody><tr><td style="text-align: center;"><a href="https://2.bp.blogspot.com/-HBkLjbTx-zA/WXjFVF8iZjI/AAAAAAAAC4o/AuBoExmRKKIn8WW0lD3TYGxT3kaXuNomQCLcBGAs/s1600/Buckminster_Fuller.jpg" imageanchor="1" style="clear: right; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" data-original-height="533" data-original-width="800" height="213" src="https://2.bp.blogspot.com/-HBkLjbTx-zA/WXjFVF8iZjI/AAAAAAAAC4o/AuBoExmRKKIn8WW0lD3TYGxT3kaXuNomQCLcBGAs/s320/Buckminster_Fuller.jpg" style="border: 1px solid rgb(112, 128, 144); box-shadow: rgb(112, 128, 144) 7px 7px 3px; margin: 5px;" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">R. Buckminster Fuller</td></tr></tbody></table><a href="https://wiki.eclipse.org/Introducing_Buckminster#How_can_Buckminster_help_me_.3F" target="_blank">The problem</a> that Buckminster is trying to solve is how to build and assemble multiple software components from multiple sources in combinations that are specific to a given target platform.<br /><br />Buckminster uses a <i><b>Component Query</b></i> (or CQUERY) to identify the components and their associated component information and create a <i><b>bill of materials</b></i> (BOM). It then locates all the components in the BOM using a <i><b>Resource Map</b></i> (or RMAP) and materializes the project by copying them into the target platform, resolving the dependencies according to the work context, system setup or operating system.<br /><br /><h3>Components</h3><div>In the context of iDempiere, a component is a collection of files that make up an OSGi bundle, or plug-in, and in the context of the Eclipse IDE, a component may be an Eclipse project. Components can also exist outside the workspace, and they may be dependent on other components.&nbsp;</div><br /><div><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; text-align: left;"><tbody><tr><td style="text-align: center;"><a href="https://4.bp.blogspot.com/-gHlF8NY5Tuc/WXjOsJuwxLI/AAAAAAAAC5A/HLUMaZIkUGAyv_I8f9TpLJ3V5tUZlqqjwCLcBGAs/s1600/RMAP_component_location_mapping.gif" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" data-original-height="360" data-original-width="504" height="227" src="https://4.bp.blogspot.com/-gHlF8NY5Tuc/WXjOsJuwxLI/AAAAAAAAC5A/HLUMaZIkUGAyv_I8f9TpLJ3V5tUZlqqjwCLcBGAs/s320/RMAP_component_location_mapping.gif" style="border: 1px solid rgb(249, 210, 249);" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">RMAP component location mapping</td></tr></tbody></table>Buckminster can store component information as a <i><b>Component Specification</b></i> (CSPEC) in an XML file inside the component, but it is also able to read meta-data from pre-existing sources such as plugin.xml, feature.xml, POM files, etc, and translate such information on-the-fly into CSPEC, which it does in the case of iDempiere.<br /><br /></div><div>Buckminster allows you to retrieve components from existing repositories and component formats, such as CVS, SVN, git, Maven, or p2 repositories. This enables the iDempiere team to integrate existing Adempiere code with bespoke iDempiere plug-ins and other third-party modules, without reconfiguring them.<br /><br />Note that Buckminster can get the same component from different repositories, depending on the circumstances (different geographic locations, for example, or different software development environments like DEV, TEST, QA, PROD, and so on), making it easy to build your own on-site repositories for iDempiere.<br /><br /></div><h2>Materializing iDempiere in Eclipse</h2><h3>Materialization Specification (MSPEC)</h3><div>When you <a href="http://wiki.idempiere.org/en/Installation_in_Eclipse" target="_blank">install iDempiere in an Eclipse development environment</a>, you must first materialize the project by using a wizard to populate the workspace from the Buckminster Materialization Specification (MSPEC): <br /><br /><b><i><span style="font-size: x-small;">File &gt; Import &gt; Buckminster &gt; Materialize from Buckminster MSPEC, CQUERY, or BOM &gt;&nbsp;</span></i></b><br /><div style="text-indent: 4em;"><span style="font-size: x-small;">URL: <b><i>$IDEMPIERE_HOME/org.adempiere.sdk-feature/adempiere.mspec</i></b></span></div><br />where $IDEMPIERE_HOME is the root directory of your iDempiere download.<br /><br />The iDempiere MSPEC instructs Buckminster to install the materialized components in <b><i>${workspace.root}/targetPlatform/</i></b>, using the Component Query in&nbsp;<b><i>adempiere.cquery</i></b>, and gives the MSPEC a human-readable name:<br /><b><i>org.adempiere.sdk:eclipse.feature:1.0.0.qualifier</i></b><br /><br /></div><div><h3> Component Query (CQUERY)</h3></div><div>Buckminster then reads the Component Query from the CQUERY file named in the MSPEC, triggering its resolution and provisioning process. The CQUERY tells Buckminster where to find the Resource Map,&nbsp;<b><i>adempiere.rmap,&nbsp;</i></b>and also defines a number of <i style="font-weight: bold;">advisorNodes</i>&nbsp;which specify how groups of components should be handled.<br /><br />The CQUERY resolution runs for a few minutes to build the Bill of Materials. The wizard gives you the option of saving the BOM to a file if you are interested in reading 20,097 lines of XML.<br /><br /><h3>Resource map (RMAP)</h3>Finally, Buckminster materializes the BOM by looking in the Resource Map (RMAP) for the location of the components and copying the JARs to the targetPlatform.<br /><br /><b>Note:</b>&nbsp;materialization takes a very looooooong time, so put the kettle on and <a href="http://download.eclipse.org/tools/buckminster/doc/BuckyBook.pdf" target="_blank">read the BuckyBook</a>, the definitive guide to Buckminster (perhaps not: see below).<br /><br /><h2>Update</h2></div><div>After this post was written, Low Heng Sin, one of the core architects of iDempiere, explained to me that they used Buckminster because Maven was not capable of building Eclipse plug-ins when the project started.<br /><br />Since then the <a href="https://eclipse.org/tycho/" target="_blank">Tycho</a>&nbsp;set of plug-ins and extensions has been developed to build OSGi bundles using Maven. &nbsp;Tycho uses OSGi metadata and OSGi rules to deduce project dependencies dynamically and inject them into the Maven project model at build time.</div><div><br /></div><div>The development of Buckminster appears to have&nbsp;<a href="http://git.eclipse.org/c/www.eclipse.org/buckminster.git/stats/?period=q&amp;ofs=10" target="_blank">come to a halt</a>&nbsp;so Tycho may be a better bet for new OSGi projects.</div><div></div>